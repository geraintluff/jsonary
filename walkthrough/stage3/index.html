<html>
  <head>
		<title>Hyperlinks in Jsonary</title>
		<link rel="stylesheet" href="../../css/main.css">
		<link rel="stylesheet" href="../../renderers/basic.jsonary.css">
		<meta name="viewport" content="width=960">
	</head>
	<body>
		<script src="http://ajax.cdnjs.com/ajax/libs/json2/20110223/json2.js"></script>
		<script src="../../jsonary.js"></script>
		<script src="../../renderers/basic.jsonary.js"></script>
		<div align="center">
			<div id="content">
				<h1>Hyperlinks</h1>
				<div class="tagline">handling links defined in JSON Schema</div>
				
				<div class="section">
					<p>The demos on this page use the following files:
					<ul>
						<li><span class="filename">jsonary.js</span> - the core Jsonary library
						<li><span class="filename">basic.jsonary.js</span> - a default set of renderers, that look similar to plain JSON
						<li><span class="filename">basic.jsonary.css</span> - the stylesheet used by the above renderers
					</ul>
				</div>
	
				<h2>Defining a hyperlink</h2>
				<div class="section">
					<p>One of the many wonders of JSON Schemas is their ability to define hyperlinks on the data that they describe.
					<p>These are defined using the <code>links</code> keyword in schemas.  Links are specified as an array of Link Description Objects, like in this example schema:
<pre class="example code">
{
	"title": "Schema with links",
	"links": [
		{
			"href": "home.json",
			"rel": "home"
		},
		{
			"href": "page2.json",
			"rel": "next"
		}
	]
}
</pre>
					<p>"<span class="user-quote">Well OK,</span>" you say, "<span class="user-quote">but the URIs are fixed!  You'll need a different schema for every bit of data!</span>".
					<p>That's a good point.  Luckily for us, JSON Schema has a way around this.  The URI specified in the <code>href</code> property is a <em>template</em>, which is filled with values from the instance data.
					<p>For example, let's look at this data: (<a href="data-list.json">data-list.json</a>)
<pre class="example code">
[
	{
		"id": 12345,
		"content": "foo"
	},
	{
		"id": 99999,
		"content": "bar"
	}
]
</pre>
					<p>We would like to define a link on each of the items in that array, pointing to comments on that item.  The URI of the link should be "<code>http://example.com/items/<I>{id}</I>/comments</code>", where <code><I>{id}</I></code> is replaced by the "id" property from the data.
					<p>Actually, that is exactly the syntax we need to use.  So let's take this schema: (<a href="schema-list.json">schema-list.json</a>)
<pre class="example code">
{
	"title": "Adaptive links",
	"items": {
		"title": "Sub-schema",
		"links": [
			{
				"href": "http://example.com/items/{id}/comments",
				"rel": "comments"
			}
		]
	}
}
</pre>
					<p>And let's render our item:<a href="#" onclick="exampleList(); return false">click to run</a>
					<div class="example" id="example-list"></div>
					<script>
function exampleList() {
	function renderData(data) {
		var element = document.getElementById('example-list');
		Jsonary.render(element, data);
	}
	Jsonary.getData("data-list.json", renderData, "schema-list.json");
}
// Put in the link handler that provides a popup with the URL
// SHHH!  We haven't learned about these yet!
Jsonary.getSchema("schema-list.json#/items", function (schema) {
	var linkDefinition = schema.links()[0];
	linkDefinition.addHandler(function (link, submissionData, request) {
		alert(link.href);
	});
});
					</script>
					<p>Hopefully, next to the schema titles annotating the data, you should see some links, labelled "comments" according to the <code>rel</code> value.
					<p>If you select these links, you should see a popup containing the URI of the link that you clicked.  The URIs are different for the two items, due to their different values for "<code>id</code>".
				</div>
			</div>
		</div>
	</body>
</html>
